<!-- 
<!doctype html><html><head><meta charset="utf-8"/><title>PreViz - Editor</title>
<link rel="stylesheet" href="style.css"/></head><body>
<div id="topbar"><button id="btnClear">Clear</button><button id="btnNew">New</button><button id="btnDownload">Download</button></div>
<main id="main"><section id="leftPanel"><canvas id="canvasSrc"></canvas></section><section id="centerPanel"><canvas id="canvasDst"></canvas></section><aside id="optionsTab" class="hidden"></aside></main>
<nav id="toolbar"></nav>
<script src="libs/opencv.js"></script>
<script src="scripts/state.js"></script><script src="scripts/uiHelpers.js"></script><script src="scripts/script.js"></script>
</body></html>
-->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PreViz - Image Preprocessing Visualizer</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Top Bar -->
    <div id="top-bar">
        <button id="btn-clear-output" class="btn-win98">Clear Output</button>
        <button id="btn-new-upload" class="btn-win98">New Upload</button>
        <button id="btn-use-output-as-input" class="btn-win98" style="display: none;">Use Output as Input</button>
        <button id="btn-download-output" class="btn-win98">Download Output</button>
    </div>

    <!-- Main Workspace -->
    <div id="workspace">
        <!-- Input Canvas -->
        <div class="canvas-zone">
            <div class="canvas-label">INPUT IMAGE</div>
            <div class="canvas-container">
                <canvas id="input-canvas" width="512" height="384"></canvas>
            </div>
        </div>

        <!-- Output Canvas -->
        <div class="canvas-zone">
            <div class="canvas-label">OUTPUT PREVIEW</div>
            <div class="canvas-container">
                <canvas id="output-canvas" width="512" height="384"></canvas>
            </div>
        </div>

        <!-- Options Panel (Popup Tab) -->
        <div id="options-panel">
            <div id="panel-header">
                <span id="panel-header-title">Options</span>
                <div id="panel-close-btn">×</div>
            </div>
            <div id="panel-content">
                <div id="panel-title">Select an operation</div>
                <div id="panel-description">Click a tool button below to configure settings</div>
                <div class="separator"></div>
                
                <!-- Dynamic Controls Container -->
                <div id="panel-controls">
                    <!-- Controls will be injected here based on selected operation -->
                </div>
            </div>
            <div id="panel-actions">
                <button id="btn-preview" class="btn-win98">Preview</button>
                <button id="btn-apply" class="btn-win98">Apply</button>
                <button id="btn-cancel" class="btn-win98">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Bottom Toolbar -->
    <div id="toolbar">
        <!-- Basic Operations -->
        <div class="toolbar-category">
            <div class="category-label">BASIC OPS</div>
            <div class="category-buttons">
                <button id="btn-color-to-gray" class="tool-btn" data-operation="colorToGray" data-category="basic">Color → Gray</button>
                <button id="btn-invert" class="tool-btn" data-operation="invert" data-category="basic">Invert</button>
                <button id="btn-transpose" class="tool-btn" data-operation="transpose" data-category="basic">Transpose</button>
                <button id="btn-bgr-rgb" class="tool-btn" data-operation="bgrRgb" data-category="basic">BGR ↔ RGB</button>
                <button id="btn-quantize" class="tool-btn" data-operation="quantize" data-category="basic">Quantize</button>
                <button id="btn-histeq" class="tool-btn" data-operation="histEq" data-category="basic">Histogram Eq</button>
            </div>
        </div>

        <div class="toolbar-divider"></div>

        <!-- Edge Operations -->
        <div class="toolbar-category">
            <div class="category-label">EDGE OPS</div>
            <div class="category-buttons">
                <button id="btn-sobel" class="tool-btn" data-operation="sobel" data-category="edge">Sobel</button>
                <button id="btn-prewitt" class="tool-btn" data-operation="prewitt" data-category="edge">Prewitt</button>
                <button id="btn-canny" class="tool-btn" data-operation="canny" data-category="edge">Canny</button>
                <button id="btn-laplace" class="tool-btn" data-operation="laplace" data-category="edge">Laplace</button>
                <button id="btn-log" class="tool-btn" data-operation="log" data-category="edge">LoG</button>
                <button id="btn-harris" class="tool-btn" data-operation="harris" data-category="edge">Harris</button>
            </div>
        </div>

        <div class="toolbar-divider"></div>

        <!-- Kernel Filters -->
        <div class="toolbar-category" id="kernel-category">
            <div class="category-label">KERNEL FILTERS</div>
            <button id="kernel-main-btn" class="tool-btn" data-role="kernel-dropdown">
                Kernel Filter ▴
            </button>
            <!-- Drop-up menu -->
            <div id="kernel-menu" class="kernel-menu hidden">
                <div class="kernel-item" data-op="blur">Box Filter</div>
                <div class="kernel-item" data-op="gaussian">Gaussian</div>
                <div class="kernel-item" data-op="median">Median</div>
                <div class="kernel-item" data-op="mean">Weighted Avg</div>
                <div class="kernel-item" data-op="max">Max Filter</div>
                <div class="kernel-item" data-op="min">Min Filter</div>
            </div>
        </div>

        <div class="toolbar-divider"></div>

        <!-- Morphological Operations -->
        <div class="toolbar-category">
            <div class="category-label">MORPHOLOGICAL OPS</div>
            <div class="category-buttons">
                <button id="btn-dilate" class="tool-btn" data-operation="dilate" data-category="morph">Dilate</button>
                <button id="btn-erode" class="tool-btn" data-operation="erode" data-category="morph">Erode</button>
                <button id="btn-open" class="tool-btn" data-operation="open" data-category="morph">Open</button>
                <button id="btn-close" class="tool-btn" data-operation="close" data-category="morph">Close</button>
                <button id="btn-hole-fill" class="tool-btn" data-operation="holefill" data-category="morph">Hole Fill</button>
            </div>
        </div>

        <div class="toolbar-divider"></div>

        <!-- Neighbourhood -->
        <div class="toolbar-category">
            <div class="category-label">NEIGHBOURHOOD</div>
            <div class="category-buttons">
                <button id="btn-neighbours" class="tool-btn" data-operation="neighbours" data-category="neighbourhood">Neighbours</button>
                <button id="btn-connectivity" class="tool-btn" data-operation="connectivity" data-category="neighbourhood">Connectivity</button>
            </div>
        </div>

        <div class="toolbar-divider"></div>

        <!-- Texture -->
        <div class="toolbar-category">
            <div class="category-label">TEXTURE</div>
            <div class="category-buttons">
                <button id="btn-glcm" class="tool-btn" data-operation="glcm" data-category="texture">GLCM</button>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script>
        // OpenCV.js loading configuration
        var Module = {
            onRuntimeInitialized: function() {
                console.log('[OpenCV.js] Runtime initialized');
                if (typeof onOpenCvReady === 'function') {
                    onOpenCvReady();
                }
            }
        };
    </script>
    <script async src="libs/opencv.js"></script>
    <script src="scripts/state.js"></script>
    <script src="scripts/uiHelpers.js"></script>
    <script src="scripts/imageOps/basicOps.js"></script>
    <script src="scripts/imageOps/kernelOps.js"></script>
    <script src="scripts/imageOps/edgeOps.js"></script>
    <script src="scripts/imageOps/morphOps.js"></script>
    <script src="scripts/imageOps/neighbourhoodOps.js"></script>
    <script src="scripts/imageOps/textureOps.js"></script>
    <script src="scripts/script.js"></script>
</body>
</html>